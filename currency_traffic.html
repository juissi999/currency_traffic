<!DOCTYPE html>
<html>

<style type="text/css">
    body {		
        font-size: 20px;
    }
    #title {
        text-align: center;
        margin-bottom: 50px;
    }
    #body {
    }
    #wrapper {
        padding: 20px 150px 150px 150px;
        margin: 50px 150px;
        border: 2px solid black;
    }
</style>
<head>
    <title>My moneyflow</title>
</head>
<body>

    <div id="wrapper">
        <div id="title">
            Add a new purchase or money input
        </div>
        <div id="body" align=center>
             <form name="input_sheet" method="post">
            Purchase: <input type="text" name="purchase" value="food">
            Price: <input type="text" name="price" value="5">
            <input id="commit-button" type="button" value="Commit">
            </form>
            <p id="spending"></p>
            <p id="data"></p>
        </div>
    </div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">
(function () { //closure
  // code
  
    var data = loadData("data.json");
    var data = [];
    
    //document.getElementById("data").innerHTML = data;
    printPurchases();
    
    $('#commit-button').click(function validateForm() {
        purchase = document.forms["input_sheet"]["purchase"].value;
        price = parseInt(document.forms["input_sheet"]["price"].value);

        if (purchase.length > 0) {
            data.push([purchase, price]);
        }
        printPurchases();
        document.forms["input_sheet"]["purchase"].value = "";
        document.forms["input_sheet"]["price"].value = 0;
    });

    function loadData(filename) {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.open('GET', filename, false); // last param: false=sync
        xmlHttp.send();
        return JSON.parse(xmlHttp.responseText);
    }
    
    function printPurchases(){
        // for (i=0;i<data.length;i++){
        var arraystr = "Recent purchases:<br>";
        //for (i=0;i<data.length;i++){
        for (i=data.length-1;i>-1;i--){
            arraystr += data[i][0];
            arraystr += ", "
            arraystr += data[i][1];
            arraystr += "<br>";
        }
        document.getElementById("data").innerHTML = arraystr;
        calcSpending();
    }
    
    function calcSpending(){
        spending = 0;
        for (i=0;i<data.length;i++){
            spending += parseInt(data[i][1]);
        }
        
        document.getElementById("spending").innerHTML = "Total spending: " + spending;
    }
//    function saveData(filename, data) {
//        var xmlHttp = new XMLHttpRequest();
  //      xmlHttp.open('SET', filename, false); // last param: false=sync
    //    xmlHttp.send();
  //  }
}());
</script>
</body>

</html>